<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>composables/useJdModalProviderSetup.ts - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow-eighties.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
    <link type="text/css" rel="stylesheet" href="styles/style.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="JdModalRef.html">JdModalRef</a><ul class='methods'><li data-type='method'><a href="JdModalRef.html#close">close</a></li><li data-type='method'><a href="JdModalRef.html#close">close</a></li><li data-type='method'><a href="JdModalRef.html#closed">closed</a></li><li data-type='method'><a href="JdModalRef.html#closed">closed</a></li><li data-type='method'><a href="JdModalRef.html#component">component</a></li><li data-type='method'><a href="JdModalRef.html#data">data</a></li><li data-type='method'><a href="JdModalRef.html#destroy">destroy</a></li><li data-type='method'><a href="JdModalRef.html#destroy">destroy</a></li><li data-type='method'><a href="JdModalRef.html#disableShadow">disableShadow</a></li><li data-type='method'><a href="JdModalRef.html#duration">duration</a></li><li data-type='method'><a href="JdModalRef.html#entryComponent">entryComponent</a></li><li data-type='method'><a href="JdModalRef.html#floatingMode">floatingMode</a></li><li data-type='method'><a href="JdModalRef.html#fullHeight">fullHeight</a></li><li data-type='method'><a href="JdModalRef.html#id">id</a></li><li data-type='method'><a href="JdModalRef.html#observeClosed">observeClosed</a></li><li data-type='method'><a href="JdModalRef.html#observeClosed">observeClosed</a></li><li data-type='method'><a href="JdModalRef.html#observeOpener">observeOpener</a></li><li data-type='method'><a href="JdModalRef.html#observeOpener">observeOpener</a></li><li data-type='method'><a href="JdModalRef.html#opener">opener</a></li><li data-type='method'><a href="JdModalRef.html#openStrategy">openStrategy</a></li><li data-type='method'><a href="JdModalRef.html#overlayClose">overlayClose</a></li><li data-type='method'><a href="JdModalRef.html#panelElement">panelElement</a></li><li data-type='method'><a href="JdModalRef.html#panelStyle">panelStyle</a></li></ul></li><li><a href="JdModalService.html">JdModalService</a><ul class='methods'><li data-type='method'><a href="JdModalService.html#close">close</a></li><li data-type='method'><a href="JdModalService.html#close">close</a></li><li data-type='method'><a href="JdModalService.html#closeAll">closeAll</a></li><li data-type='method'><a href="JdModalService.html#closeAll">closeAll</a></li><li data-type='method'><a href="JdModalService.html#closeById">closeById</a></li><li data-type='method'><a href="JdModalService.html#closeById">closeById</a></li><li data-type='method'><a href="JdModalService.html#closeByRef">closeByRef</a></li><li data-type='method'><a href="JdModalService.html#closeByRef">closeByRef</a></li><li data-type='method'><a href="JdModalService.html#destroy">destroy</a></li><li data-type='method'><a href="JdModalService.html#destroy">destroy</a></li><li data-type='method'><a href="JdModalService.html#dispatchChangeState">dispatchChangeState</a></li><li data-type='method'><a href="JdModalService.html#dispatchChangeState">dispatchChangeState</a></li><li data-type='method'><a href="JdModalService.html#getModalRef">getModalRef</a></li><li data-type='method'><a href="JdModalService.html#getModalRef">getModalRef</a></li><li data-type='method'><a href="JdModalService.html#getState">getState</a></li><li data-type='method'><a href="JdModalService.html#getState">getState</a></li><li data-type='method'><a href="JdModalService.html#hasModal">hasModal</a></li><li data-type='method'><a href="JdModalService.html#hasModalRefNext">hasModalRefNext</a></li><li data-type='method'><a href="JdModalService.html#hasModalRefNext">hasModalRefNext</a></li><li data-type='method'><a href="JdModalService.html#init">init</a></li><li data-type='method'><a href="JdModalService.html#init">init</a></li><li data-type='method'><a href="JdModalService.html#isModalRefTop">isModalRefTop</a></li><li data-type='method'><a href="JdModalService.html#isModalRefTop">isModalRefTop</a></li><li data-type='method'><a href="JdModalService.html#modals">modals</a></li><li data-type='method'><a href="JdModalService.html#observeModalState">observeModalState</a></li><li data-type='method'><a href="JdModalService.html#observeModalState">observeModalState</a></li><li data-type='method'><a href="JdModalService.html#onChangeModalState">onChangeModalState</a></li><li data-type='method'><a href="JdModalService.html#onChangeModalState">onChangeModalState</a></li><li data-type='method'><a href="JdModalService.html#open">open</a></li><li data-type='method'><a href="JdModalService.html#open">open</a></li><li data-type='method'><a href="JdModalService.html#pushOrder">pushOrder</a></li><li data-type='method'><a href="JdModalService.html#pushOrder">pushOrder</a></li><li data-type='method'><a href="JdModalService.html#pushOrderById">pushOrderById</a></li><li data-type='method'><a href="JdModalService.html#pushOrderById">pushOrderById</a></li><li data-type='method'><a href="JdModalService.html#resetDefaultEntryComponent">resetDefaultEntryComponent</a></li><li data-type='method'><a href="JdModalService.html#resetDefaultEntryComponent">resetDefaultEntryComponent</a></li><li data-type='method'><a href="JdModalService.html#setDefaultEntryComponent">setDefaultEntryComponent</a></li><li data-type='method'><a href="JdModalService.html#setDefaultEntryComponent">setDefaultEntryComponent</a></li><li data-type='method'><a href="JdModalService.html#setUseBlockBodyScroll">setUseBlockBodyScroll</a></li><li data-type='method'><a href="JdModalService.html#setUseBlockBodyScroll">setUseBlockBodyScroll</a></li><li data-type='method'><a href="JdModalService.html#setUseHistoryState">setUseHistoryState</a></li><li data-type='method'><a href="JdModalService.html#setUseHistoryState">setUseHistoryState</a></li><li data-type='method'><a href="JdModalService.html#swapOrder">swapOrder</a></li><li data-type='method'><a href="JdModalService.html#swapOrder">swapOrder</a></li><li data-type='method'><a href="JdModalService.html#swapOrderTopById">swapOrderTopById</a></li><li data-type='method'><a href="JdModalService.html#swapOrderTopById">swapOrderTopById</a></li><li data-type='method'><a href="JdModalService.html#swapOrderTopByRef">swapOrderTopByRef</a></li><li data-type='method'><a href="JdModalService.html#swapOrderTopByRef">swapOrderTopByRef</a></li><li data-type='method'><a href="JdModalService.html#usedBlockBodyScroll">usedBlockBodyScroll</a></li><li data-type='method'><a href="JdModalService.html#usedHistoryState">usedHistoryState</a></li></ul></li></ul><h3>Interfaces</h3><ul><li><a href="JdModalBeforeLeaveHook.html">JdModalBeforeLeaveHook</a></li><li><a href="JdModalEntrySetupConfig.html">JdModalEntrySetupConfig</a></li><li><a href="JdModalEntrySetupHook.html">JdModalEntrySetupHook</a></li><li><a href="JdModalProviderSetupHook.html">JdModalProviderSetupHook</a></li><li><a href="JdModalScrollPreventHook.html">JdModalScrollPreventHook</a></li><li><a href="ModalConfig.html">ModalConfig</a></li><li><a href="ModalData.html">ModalData</a></li><li><a href="ModalEvent.html">ModalEvent</a></li><li><a href="ModalPopStateEvent.html">ModalPopStateEvent</a></li><li><a href="ModalState.html">ModalState</a></li></ul><h3>Global</h3><ul><li><a href="global.html#JD_MODAL_REF_TOKEN">JD_MODAL_REF_TOKEN</a></li><li><a href="global.html#JD_MODAL_SERVICE_TOKEN">JD_MODAL_SERVICE_TOKEN</a></li><li><a href="global.html#ModalEventType">ModalEventType</a></li><li><a href="global.html#ModalOpenStrategy">ModalOpenStrategy</a></li><li><a href="global.html#sleep">sleep</a></li><li><a href="global.html#useJdModalBeforeLeave">useJdModalBeforeLeave</a></li><li><a href="global.html#useJdModalEntrySetup">useJdModalEntrySetup</a></li><li><a href="global.html#useJdModalProviderSetup">useJdModalProviderSetup</a></li><li><a href="global.html#useJdModalPullDownClose">useJdModalPullDownClose</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">composables/useJdModalProviderSetup.ts</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { Subscription } from 'rxjs';
import { computed, shallowReactive } from 'vue';
import { useJdModalService, JdModalRef } from '../modules';
import { ModalState } from '../modules/types';

/**
 * @interface
 * @property mounted {Function} 마운트시 호출되어야 할 함수
 * @property unmounted {Function} 언마운트시 호출되어야 할 함수
 * @property modals {Ref&lt;JdModalRef[]>} 현재 열려있는 전체 모달
 * @property classes {any} 모달 컨테이너에 필요한 html class 세트
 */
interface JdModalProviderSetupHook {
  mounted: Function;
  unmounted: Function;
  state: HookState;
  classes: any;
}

interface HookState {
  modals: JdModalRef[];
  emptied: boolean;
}

/**
 * 모달의 Provider 컴포넌트 기능 훅.
 * @export
 * @returns {JdModalProviderSetupHook}
 */
export const useJdModalProviderSetup = (): JdModalProviderSetupHook => {
  const service = useJdModalService();
  let listener: Subscription;
  let animateTimer: any = null;

  const state = shallowReactive&lt;HookState>({
    modals: service.modals,
    emptied: true
  });

  const classes = computed(() => {
    const modals = state.modals;
    const hasModal = !!(modals &amp;&amp; modals.length);
    const emptied = state.emptied;
    return {
      'has-modal': hasModal,
      'is-emptied': emptied
    };
  });

  const onChangeModalState = (modalState: ModalState) => {
    const { modals } = modalState;
    const hasModal = !!(modals &amp;&amp; modals.length);
    state.modals = modals;
    clearTimeout(animateTimer);
    if (hasModal) {
      state.emptied = false;
    } else {
      animateTimer = setTimeout(() => {
        state.emptied = true;
      }, 140);
    }
  };

  const mounted = () => {
    listener = new Subscription();
    const observeModalState = service.observeModalState().subscribe(onChangeModalState);
    listener.add(observeModalState);
  };

  const unmounted = () => {
    listener.unsubscribe();
    service.destroy();
  };

  return {
    mounted,
    unmounted,
    classes,
    state
  };
};
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated at Thu Feb 24 2022 22:03:03 GMT+0000 (Coordinated Universal Time)
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
